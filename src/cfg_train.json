{
    "preprocess": {
        "preprocessor": {
            "type": "CocoClassifierPreprocessor",
            "args": {
                "img_in_dir_path": "data/raw/COCO-2017/validate",
                "ann_file_path": "data/raw/COCO-2017/instances_val2017.json",
                "img_out_dir_path": "data/processed/COCO-2017/validate/",
                "img_out_shape": [
                    250,
                    250
                ],
                "label_pos": "person",
                "label_neg": [
                    "car",
                    "bus",
                    "truck",
                    "motorcycle",
                    "bicycle",
                    "train",
                    "boat"
                ] 
            }
        }
    },
    "train": {
        "name": "Classifier",
        "n_gpu": 1,
        "arch": {
            "type": "Classifier"
        },
        "data_loader": {
            "type": "ClassifierDataLoader",
            "args": {
                "images_folder": "data/processed/validate/images",
                "batch_size": 128,
                "csv_path": "data/df_train_framefilter.csv",
                "csv_path_tf": "data/df_train_framefilter_rs.csv",
                "shuffle": true,
                "validation_split": 0.2,
                "num_workers": 2
            }
        },
        "optimizer": {
            "type": "Adam",
            "args": {
                "lr": 0.0001,
                "weight_decay": 0,
                "amsgrad": true
            }
        },
        "loss": "cross_entropy_loss",
        "metrics": [
            "micro_accuracy",
            "micro_recall",
            "micro_precision",
            "micro_f1",
            "macro_accuracy",
            "macro_recall",
            "macro_precision",
            "macro_f1"
        ],
        "lr_scheduler": {
            "type": "StepLR",
            "args": {
                "step_size": 50,
                "gamma": 0.1
            }
        },
        "trainer": {
            "epochs": 100,
            "save_dir": "res/models/classifier_person/",
            "save_period": 1,
            "verbosity": 2,
            "monitor": "min val_loss",
            "early_stop": 10,
            "tensorboard": true
        }
    },
    "test": {
        "model_to_load_path": "res/models/classifier_person/model_best.pth",
        "predicting": {
            "results_file": "results.csv",
            "test_folder": "data/processed/COCO-2017/images"
        },
        "data_loader": {
            "type": "ClassifierDataLoader",
            "args": {
                "images_folder": "data/processed/validate/",
                "batch_size": 128,
                "csv_path": "data/df_train_framefilter.csv",
                "csv_path_tf": "data/df_train_framefilter_rs.csv",
                "shuffle": false,
                "validation_split": 0.0,
                "num_workers": 2,
                "is_train": false
            }
        }
    }
}